<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horizontal Bar Chart with Tooltip</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
        }
        .container {
            display: flex;
            align-items: flex-start;
            padding: 20px;
            box-sizing: border-box;
        }
        .text-content {
            width: 300px; /* Adjust width as needed */
            margin-right: 20px; /* Space between text and chart */
        }
        .tooltip {
            position: absolute;
            background-color: rgba(0, 0, 0, 0.7);
            color: #fff;
            padding: 5px;
            border-radius: 3px;
            pointer-events: none;
            display: none;
        }
        svg {
            border: 1px solid #ccc; /* Optional: adds a border around the SVG */
        }
        .bar {
            fill: steelblue;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="text-content">
             <h2>The Heaviest Meteorites Ever Recorded</h2>
                <p>According to National Geographic, the largest meteorite ever discovered on Earth is the Hoba meteorite, found in Namibia in 1920. 
                    Weighing approximately 54,000 kilograms (119,000 pounds), the Hoba meteorite is so massive that it remains in its original location. 
                    Its enormous size and weight make it impossible to move, and it has been preserved exactly where it was discovered. 
                    This remarkable meteorite offers a unique opportunity to study an extraterrestrial object in its natural setting.
                </p>
        </div>
        <svg width="800" height="600"></svg>
    </div>
    <div class="tooltip"></div>
    <script>
        // Define dimensions and margins
        const margin = { top: 20, right: 20, bottom: 30, left: 150 },
              width = 800 - margin.left - margin.right,
              height = 600 - margin.top - margin.bottom;

        // Create SVG container
        const svg = d3.select("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
          .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        // Load data
        Promise.all([
            d3.csv('https://skillet64.github.io/498/biggest.csv'),
            d3.csv('https://skillet64.github.io/498/Sheet 1-ml-Meteorite_Landings.csv')
        ]).then(([biggestData, landingsData]) => {
            
            // Process data
            biggestData.forEach(d => {
                d.mass = +d['mass (g) (Sum)'];
            });

            landingsData.forEach(d => {
                d.reclat = +d.reclat;
                d.reclong = +d.reclong;
            });

            // Create a map of IDs to their corresponding landing data
            const landingMap = new Map(landingsData.map(d => [d.name, d]));

            // Sort data in descending order by mass
            biggestData.sort((a, b) => b.mass - a.mass);

            // Define scales
            const x = d3.scaleLinear()
                .domain([0, d3.max(biggestData, d => d.mass)])
                .range([0, width]);

            const y = d3.scaleBand()
                .domain(biggestData.map(d => d.name))
                .range([0, height])
                .padding(0.1);

            // Create tooltip
            const tooltip = d3.select(".tooltip");

            // Draw bars
            svg.selectAll(".bar")
                .data(biggestData)
                .enter().append("rect")
                .attr("class", "bar")
                .attr("x", 0)
                .attr("y", d => y(d.name))
                .attr("width", d => x(d.mass))
                .attr("height", y.bandwidth())
                .on("mouseover", function(event, d) {
                    const landing = landingMap.get(d.name);
                    tooltip
                        .style("display", "block")
                        .html(`Name: ${d.name}<br>Mass: ${d.mass} g<br>Year: ${landing ? landing.year : 'N/A'}<br>Lat: ${landing ? landing.reclat : 'N/A'}<br>Long: ${landing ? landing.reclong : 'N/A'}`);
                })
                .on("mousemove", function(event) {
                    tooltip
                        .style("top", (event.pageY + 5) + "px")
                        .style("left", (event.pageX + 5) + "px");
                })
                .on("mouseout", function() {
                    tooltip.style("display", "none");
                });

            // Remove X and Y axis (No axis)
            svg.selectAll(".axis").remove();

        }).catch(error => {
            console.error('Error loading data:', error);
        });
    </script>
</body>
</html>
